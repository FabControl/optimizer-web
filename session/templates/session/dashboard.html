
{% extends "session/base.html" %}
{% block content %}
{% load static %}
<script src="{% static 'session/js/sortable.min.js' %}"></script>
<link rel="stylesheet" href="{% static 'session/css/sortable-theme-bootstrap.css' %}" />
<div class="container pt-3">
  <div class="row pt-2">
    <div class="col-sm">
      <p class='lead'><font size='6'>Welcome to 3DOptimizer!</font></p>
    </div>
  </div>
  {% if cards.sessions.len < 1 %}
  <div class="row pt-5 pb-5">
    <div class="col-sm text-center">
      <button type="button" onclick="location.href='{% url 'new_session' %}'" class="btn-lg btn-primary">Start a new testing session</button>
    </div>
  </div>
  <div class="row">
    <div class="col-sm">
      <p>A video overview, user manual and other support options are available in the Help menu.</p>
      <p>When you return, this page will show your recent testing sessions.</p>
    </div>
  </div>
  {% else %}
  <div class="row pt-2">
    <div class="col-sm">
      <div class="card p-2 text-center shadow-sm" style='background: #f8f9fa'>
        <p class='lead'>Testing sessions</p>
        <p class='display-2'>{{cards.sessions.len}}</p>
        <a href="{% url 'session_manager' %}">View all sessions</a>
      </div>
    </div>
    <div class="col-sm">
      <div class="card p-2 text-center shadow-sm" style='background: #f8f9fa'>
        <p class='lead'>Printers</p>
        <p class='display-2'>{{cards.printers.len}}</p>
        <a href="{% url 'machine_manager' %}">View all printers</a>
      </div>
    </div>
    <div class="col-sm">
      <div class="card p-2 text-center shadow-sm" style='background: #f8f9fa'>
        <p class='lead'>Materials</p>
        <p class='display-2'>{{cards.materials.len}}</p>
        <a href="{% url 'material_manager' %}">View all materials</a>
      </div>
    </div>
  </div>
  <div class="row pt-3">
    <div class="col-sm">
      <div class="pt-3 pb-2">
        <h3>Recent testing sessions</h3>
      </div>
      <table class="sortable sortable-theme-bootstrap table" data-sortable>
        <thead>
          <tr>
            <th>Session name</th>
            <th>Printer</th>
            <th>Material</th>
            <th>Target</th>
            <th>Completed tests</th>
            <th data-defaultsort="asc">Date</th>
          </tr>
        </thead>
        <tbody>
          {# ROW CONTENTS #}
          {% for session in latest_sessions %}
          <tr>
            {% if  session.completed %}
              <td><a class="text-secondary" href="{% url 'session_overview' session.pk %}">{{ session.name }}</a></td>
            {% else %}
              <td><a class="text-secondary" href="{% url 'session_detail' session.pk %}">{{ session.name }}</a></td>
            {% endif %}
            <td><a class="text-secondary">{{ session.machine.model }}</a></td>
            <td><a class="text-secondary">{{ session.material.name }}</a></td>
            <td>{{session.get_target_display}}</td>
            <td>{{session.completed_tests}}</td>
            <td>{{session.pub_date}}</td>
          </tr>
          {% endfor %}

        </tbody>
      </table>
    </div>
  </div>
  <div class="row">
    <div class="col-sm">
      <button type="button" onclick="location.href='{% url 'new_session' %}'" class="btn btn-primary">Start a new testing session</button>
    </div>
  </div>
  {%  endif %}
</div>
{% if request.user.onboarding and 'dashboard' in request.user.onboarding_sections %}
{% include 'session/tour.html' %}
{% endif %}
{% endblock %}
