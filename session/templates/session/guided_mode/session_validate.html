{% load crispy_forms_tags %}
{% load static %}
{% if request.path in request.META.HTTP_REFERER and offer_download %}<iframe width="1" height="1" frameborder="0" src="{% url 'gcode' object.pk %}"></iframe>{% endif %}
<form id="validation-form" class="" action="" method="POST">
  <div class="row pt-3">
    <div class="col-sm-12">
      <p><b>Print the downloaded test file</b><br>If the test gcode didn't download, you can get it <a href="{% url 'gcode' object.pk %}">here</a>.</p>
    </div>
  </div>
  <div class="row">
    <div class="col-sm">
      <p><b>Inspect the printed test structure</b></p>
    </div>
  </div>
  <div class="row">
    <div class="col-sm">
      {% if not object.test_info.hint_valid == " " %}
      <span>{{ object.test_info.hint_valid|safe }}</span>
      {% endif %}
    </div>
  </div>
  <div class="row">
    <div class="col-sm">
      {% if questions %}
      {% crispy question_form %}
      <div class="pt-4 pb-2">
        <p><b>Select all good parameter combinations</b></p>
      </div>
      {% endif %}
      <div class="valid-form">
        {% crispy form %}
      </div>
    </div>
  </div>
  <div class="row pt-2">
    <div class="col">
      <button class="btn btn-secondary" onclick="location.href='{% url 'session_validate_back' object.pk %}'" type="button" name="button">Back to Setup</button>
    </div>
    <div class="col text-right">
      <button type="submit" name="btnprimary" class="btn btn-primary">Next Test</button>
    </div>
  </div>
</form>
<script type="text/javascript">
  // Client-side check that at least one checkbox has been selected
  $('button[type="submit"]').on('click', function() {
    $cbx_group = $("input:checkbox[name='validation']");
    $cbx_group.prop('required', true);
    if ($cbx_group.is(":checked")) {
      $cbx_group.prop('required', false);
    }
  });
</script>
